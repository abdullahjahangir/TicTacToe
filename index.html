<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe</title>
    <style>
        table,td, th {
            border: 2px solid black;
            border-spacing: 0px;
            margin: auto;
            background-color: whitesmoke;
        }
        td
        {
            width: 100px;
            height: 100px;
            text-align: center;
            font-size: 80px;
            /* padding: 50px; */
        }
        body{
            background-color: blueviolet;
        }
        #playAgain
        {
            margin: 10px auto;background-color: burlywood;border-radius: 10px;text-align: center;font-size: 50px;width: 300px;   
        }
        #playAgain:hover{
            /* margin: 10px auto;background-color: red;border-radius: 10px;text-align: center;font-size: 50px;width: 300px; */
            background-color: brown;
        }
        /* .btn
        {
            
        } */
    </style>
</head>
<body>
    <div style="margin: 30px auto;background-color: greenyellow;border-radius: 10px;text-align: center;font-size: 80px;width: 400px;">
        Tic Tac Toe
    </div>
    <div onclick="play(event)" id="playAgain"></div>
    <div id="player" style="margin: 10px auto;background-color: lightcoral;border-radius: 10px;text-align: center;font-size: 50px;width: 400px;">
    </div>
    <table>
        <tbody>
            <tr>
                <td onclick="perform(event)" id="0,0"></td>
                <td onclick="perform(event)" id="0,1"></td>
                <td onclick="perform(event)" id="0,2"></td>
            </tr>
            <tr>
                <td onclick="perform(event)" id="1,0"></td>
                <td onclick="perform(event)" id="1,1"></td>
                <td onclick="perform(event)" id="1,2"></td>
            </tr>
            <tr>
                <td onclick="perform(event)" id="2,0"></td>
                <td onclick="perform(event)" id="2,1"></td>
                <td onclick="perform(event)" id="2,2"></td>
            </tr>
        </tbody>
    </table>
    <script>
        let flag = true;
        let count = 0;
        let count1 = 0;
        let count2 = 0;

        function play(event)
        {
            let playAgain = document.getElementById("playAgain")
            playAgain.style = ""
            playAgain.innerText = "";
            flag = true;
            count = 0;
            count1 = 0;
            count2 = 0;
            player();
            let i=0;
            let j=0;
            let id;
            while(i<3)
            {
                while(j<3)
                {
                    id = i.toString() + "," + j.toString();
                    document.getElementById(id).innerText = ""
                    document.getElementById(id).style.backgroundColor = "whitesmoke";
                    j=j+1;
                }
                i=i+1;
                j=0;
            }
        }

        function playAgain()
        {
            console.log("play again");
            let playAgain = document.getElementById("playAgain")
            // playAgain.style = ""
            playAgain.innerText = "Play Again !!!";
        }
        
        function player()
        {
            console.log("Player");
            console.log("flag: ",flag);
            if(flag===true)
            {
                document.getElementById("player").innerText = "Player 1";
            }
            else if(flag===false)
            {
                document.getElementById("player").innerText = "Player 2";
            }
            else if(flag==1)
            {
                console.log("Change to 1");
                document.getElementById("player").innerText = "Player 1 Wins The Game";
                playAgain();
            }
            else if(flag==2)
            {
                document.getElementById("player").innerText = "Player 2 Wins The Game";
                playAgain();
            }
            else if(flag==3)
            {
                document.getElementById("player").innerText = "Game Draw";
                playAgain();
            }
        }

        function lineTrough(l)
        {
            let i=0;
            while (i<3)
            {
                document.getElementById(l[i]).style.backgroundColor = "red";
                i=i+1;
            }
        }

        function rightDiagnol(toe)
        {
            console.log("rightDiagnol");
            let i=0;
            let j=2;
            let id;
            let count=0;
            let l = []
            while(i<3 && j>-1)
            {
                id = i.toString() + "," + j.toString();
                console.log("ID: ",id);
                if(document.getElementById(id).innerText == toe)
                {
                    console.log("Yes");
                    count = count + 1;
                    console.log("Count: ",count);
                    l.push(id);
                    if(count==3)
                    {
                        lineTrough(l);
                        return true;
                    }   
                }
                else
                {
                    console.log("NO");
                    break;
                }
                j = j - 1;
                i = i + 1;
            }
            return false;
        }
        function leftDiagnol(toe)
        {
            console.log("leftDiagnol");
            let i=0;
            let j=0;
            let id;
            let count=0;
            let l=[];
            while(i<3 && j<3)
            {
                id = i.toString() + "," + j.toString();
                console.log("ID: ",id);
                if(document.getElementById(id).innerText == toe)
                {
                    console.log("Yes");
                    count = count + 1;
                    console.log("Count: ",count);
                    l.push(id);
                    if(count==3)
                    {
                        console.log("Yes Yes Yes");
                        lineTrough(l);
                        return true;
                    }   
                }
                else
                {
                    console.log("NO");
                    break;
                }
                j = j + 1;
                i = i + 1;
            }
            return false;
        }
        function horizontal(toe)
        {
            console.log("horizontal");
            let i=0;
            let j=0;
            let id;
            let count=0;
            let l=[];
            while(i<3)
            {
                while(j<3)
                {
                    id = i.toString() + "," + j.toString();
                    console.log("ID: ",id)
                    if(document.getElementById(id).innerText == toe)
                    {
                        j = j + 1;
                        count = count + 1;
                        l.push(id);
                        if(count==3)
                        {
                            lineTrough(l);
                            return true;
                        }  
                        console.log("YES"); 
                    }
                    else
                    {
                        j = j + 1;
                        console.log("No");
                        break;
                    }
                }
                l=[];
                count = 0;
                i = i + 1;
                j = 0
            }
            return false;
        }
        function vertical(toe)
        {
            console.log("vertical");
            let i=0;
            let j=0;
            let id;
            let count=0;
            let l=[];
            while(i<3)
            {
                while(j<3)
                {
                    id = j.toString() + "," + i.toString();
                    console.log("ID: ",id)
                    if(document.getElementById(id).innerText == toe)
                    {
                        j = j + 1;
                        count = count + 1;
                        l.push(id);
                        if(count==3)
                        {
                            lineTrough(l);
                            return true;
                        }   
                        console.log("YES");
                    }
                    else
                    {
                        j = j + 1;
                        console.log("NO");
                        break;
                        
                    }
                }
                l=[];
                count = 0;
                i = i + 1;
                j = 0
            }
            return false;
        }
        function check(toe)
        {
            if(vertical(toe)==true)
            {
                return true;
            }
            if(horizontal(toe)==true)
            {
                return true;
            }
            if(leftDiagnol(toe)==true)
            {
                console.log("leftDiagnol is True");
                return true;
            }
            if(rightDiagnol(toe)==true)
            {
                return true;
            }
            return false;
        }
        function checkStatus()
        {
            console.log("checkStatus Called");
            console.log("flag: ",flag);
            if(flag==true)
            {
                if(count1>2)
                {
                    console.log("Player 1 checkStatus Called");
                    if(check("X")==true)
                    {
                        console.log("Player 1 Wins");
                        flag = 1;
                        player();
                    }
                }
            }
            else
            {
                if(count2>2)
                {
                    if(check("O")==true)
                    {
                        flag = 2;
                        player();
                    }
                }
            }
        }

        function perform(event)
        {
            if(flag==true)
            {
                
                if(document.getElementById(event.target.id).innerText == "")
                {
                    count = count + 1;
                    document.getElementById(event.target.id).innerText = "X"
                    document.getElementById(event.target.id).style.color = "gold";
                    count1 = count1 + 1;
                    checkStatus();
                    console.log("Flag: ",flag)
                    if(flag===true)
                    {
                        flag = false;
                    }
                }
            }
            else if(flag==false)
            {
                if(document.getElementById(event.target.id).innerText == "")
                {
                    count = count + 1;
                    document.getElementById(event.target.id).innerText = "O"
                    document.getElementById(event.target.id).style.color = "green"
                    count2 = count2 + 1;
                    checkStatus();
                    if(flag==false)
                    {
                        flag = true;
                    }
                }
            }
            if(count==9)
            {
                flag=3;
                // console.log("PLay again called");
                // playAgain();
            }
            console.log("Count1: ",count1);
            console.log("Count2: ",count2);
            player();    
        }    
        player();    
    </script>
</body>
</html>